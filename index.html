<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dentur Klinik Pergigian Jasin</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <!-- title -->

    <div class="header">
      <h1>Dentur Klinik Pergigian Jasin</h1>

      <div>
        <p class="kpititle">Pencapaian semasa tahun 2026<br>(Mengambil kira kes yang sudah EXP dan sudah diisu)</p>
        <p class="kpiresult">Orang Dewasa 90 Hari (Sasaran ≥ 96%)</p>
        <p id="kpi1" class="kpiresult"></p>
        <p class="kpiresult">Warga Emas 56 Hari (Sasaran ≥ 75%)</p>
        <p id="kpi2" class="kpiresult"></p>
      </div>

      <div class="button">
        <div class="center1">
        <button class="buttonreten"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1_dgujx0ttP9xcJql-GvtO-W3kJPp5VX0N9RJRRwS1kM/edit?usp=sharing')"
        >
          PG 103 (PRIMER)
        </button>
        <button class="buttonreten"
          onclick="window.open('https://docs.google.com/spreadsheets/d/14wxzAm1FGupga9UzKTwbaYYQS9y5WpmozBgiVMhEtLg/edit?usp=sharing')"
        >
          PG 205 (PRIMER)
        </button>
        <button class="buttonreten"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1SyNcE-w8CRAI5BuH2ssCvJ_bjA35Hm3jgdybqntTjZk/edit?usp=sharing')"
        >
          PG 103 (ORTHO)
        </button>
        <button class="buttonreten"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1T3iSpNLKQu1jKnlcfg9_N33UkyxHqy5dePYp-LA38T8/edit?usp=sharing')"
        >
          PG 205 (ORTHO)
        </button>
        </div>

        <br />
        <br />
        
        <div class="center2">
        <button class="buttonlist"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1Hs7msioZ1WfubrMbPmua3JAfcV-mYJMjP4AP5zIbcIg/edit?usp=sharing')"
        >
          Senarai Pesakit (Primer)
        </button>
        <button class="buttonlist"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1sK08dxjsQgc2SJtzZcjaiReRTj6dSYw8ruogH4nmIdg/edit?usp=sharing')"
        >
          Senarai Pesakit (Ortho)
        </button>
        </div>

        <br />
        <br />

        <div class="center3">
        <button class="buttonkpi"
          onclick="window.open('https://docs.google.com/spreadsheets/d/1WKm5cQ4-fnaYHeRgEkWrrKMh98xIxwTJnHq8mg_etec/edit?usp=sharing')"
        >
          KPI
        </button>
      </div>
      </div>

     <br />
     <br />

    <div style="position:relative;">
    <center>
      <iframe
        class="frame"
        id="frame"
        height="3000rem"
        width="900rem"
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRjYA458p8O0IIM1MjGW8GobdGDoTPJ0zqNeBskwpbM9Yst5MG6BU14PTzglleuZevhUP_8xtcG7ki0/pubhtml?gid=1057504322&single=true"
      ></iframe>
    </center>
    </div>
  </body>
</html>

<script>

  const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-LpqHK2ZLSfTUB3Te4DCVF-z6k_DsyvyKAnBhYypsgIe6w2DQ6ZzHqrgPt0q192F7FfYahC8BeEyT/pub?gid=789477847&single=true&output=csv";
  const kpi1 = document.querySelector("#kpi1");
  const kpi2 = document.querySelector("#kpi2");
  const color1 = document.getElementById("kpi1");
  const color2 = document.getElementById("kpi2");

  kpi1.innerHTML = "<p>Sedang Dimuatkan...</p>"
  kpi2.innerHTML = "<p>Sedang Dimuatkan...</p>"

  fetch(url)
  .then(result=>result.text())
  .then(csvtext=>kpi1.innerHTML=csvtext.substring(0,csvtext.indexOf(",")));

  fetch(url)
  .then(function(result) {return result.text()})
  .then(function(csvtext) { 
    if(parseFloat(csvtext.substring(0,csvtext.indexOf(",")-1))<96) {
      color1.style.color = "red";
    }
    else {
      color1.style.color = "green";
    }

  });

  fetch(url)
  .then(result=>result.text())
  .then(csvtext=>kpi2.innerHTML=csvtext.substring(csvtext.indexOf(",")+1,csvtext.length));

   fetch(url)
  .then(function(result) {return result.text()})
  .then(function(csvtext) { 
    if(parseFloat(csvtext.substring(csvtext.indexOf(",")+1,csvtext.length-1))<75) {
      color2.style.color = "red";
    }
    else {
      color2.style.color = "green";
    }

  });


 
  

  
</script>
